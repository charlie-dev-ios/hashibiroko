# Research: カビゴン評価ランクデータの実データ対応

## R-001: 実際のゲームのランク構造

**Decision**: ノーマル1-5、スーパー1-5、ハイパー1-5、マスター1-20の35段階を採用
**Rationale**: ポケモンスリープの実際のゲーム内データと一致。ユーザー提供のスクリーンショットで確認済み。
**Alternatives considered**: なし（ゲームデータに合わせることが要件）

## R-002: データソースの信頼性

**Decision**: ポケモンWiki（wiki.xn--rckteqa2e.com）のカビゴン(Sleep)ページのデータを使用
**Rationale**: ユーザー提供のスクリーンショット（ゴールド旧発電所）の値と完全一致を確認
- ノーマル3: 46,326 / 291 → 一致
- ノーマル4: 75,531 / 325 → 一致
- ノーマル5: 110,779 / 392 → 一致
- スーパー1: 151,061 / 448 → 一致
- スーパー2: 203,429 / 582 → 一致

**Alternatives considered**: game8.jp（データ不完全）、wikiwiki.jp（アクセス制限あり）

## R-003: データモデルの変更方針

**Decision**: 既存の`SnorlaxRankNameSchema`のenum値を4ティア名に変更し、ティア内番号フィールドと報酬フィールドを追加
**Rationale**:
- 現在: `rank` (enum of 6 names) + `requiredEnergy` + `newPokemonIds`
- 変更後: `rankTier` (enum of 4 tiers) + `rankNumber` (1-5 or 1-20) + `requiredEnergy` + `dreamShards` + `newPokemonIds`
- `IslandSchema`の`snorlaxRanks`配列長を`.length(6)`から`.length(35)`に変更

**Alternatives considered**:
1. ランク名を「ノーマル 1」のような文字列として保持 → 却下：バリデーションが弱くなる
2. 全35ランク名をenumに列挙 → 却下：冗長すぎ、YAGNIに反する

## R-004: コンポーネントの表示変更

**Decision**: `snorlax-rank-table.tsx`に報酬カラムを追加し、ランク名を「{ティア} {番号}」形式で表示
**Rationale**: ゲーム内の表示形式（スクリーンショット参照）に合わせる
**Alternatives considered**: 別コンポーネント作成 → 却下：既存コンポーネントの修正で十分

## R-005: フィールド間のエナジー比率

**Decision**: 各フィールドの必要エナジーはフィールド固有の値を個別にJSONに記録
**Rationale**: データ確認の結果、フィールド間の倍率は厳密な固定値ではなく、ランクごとに微妙に異なる。計算式での算出ではなく実測値を使用する。

エナジー比率（マスター20基準、ワカクサ = 1.00）:
- ワカクサ本島: 1.00（3,245,795）
- シアンの砂浜: 1.15（3,732,644）
- トープ洞窟: 1.30（4,219,534）
- ウノハナ雪原: 1.45（4,706,403）
- ラピスラズリ湖畔: 1.60（5,193,272）
- ゴールド旧発電所: 2.06（6,674,166）

## R-006: 出現ポケモンデータの扱い

**Decision**: 初期リリースではnewPokemonIdsを空配列で統一し、ランク別出現ポケモンデータは別タスクで対応
**Rationale**: 35ランク × 6フィールドの出現ポケモンデータは膨大で、正確なデータ収集に時間がかかる。まずランク構造・エナジー・報酬データの正確性を優先し、出現ポケモンは段階的に追加する。
**Alternatives considered**: 全データを一括で更新 → スコープが大きくなりすぎるため段階的に実施
