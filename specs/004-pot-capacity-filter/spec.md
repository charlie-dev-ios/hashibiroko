# Feature Specification: 鍋容量フィルター

**Feature Branch**: `004-pot-capacity-filter`
**Created**: 2026-01-30
**Status**: Draft
**Input**: User description: "料理一覧画面で鍋の容量（一度に使用できる食材の数）を指定し、その数以下の料理のみ表示できるようにする。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 鍋容量で料理をフィルタリングする (Priority: P1)

ユーザーは自分が持っている鍋の容量に基づいて、作成可能な料理だけを表示したい。例えば、鍋容量が50の場合、食材数が50以下の料理のみを確認できるようにしたい。これにより、実際に作れない料理を除外し、効率的にレシピを探せる。

**Why this priority**: これがこの機能の核心的なユースケースであり、ユーザーが最も必要としている機能である。

**Independent Test**: 鍋容量を入力し、その容量以下の料理のみが表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** 料理一覧画面を表示している, **When** 鍋容量として50を入力する, **Then** 食材数（ingredientCount）が50以下の料理のみが表示される
2. **Given** 鍋容量フィルター（例：50）が適用されている, **When** 鍋容量を30に変更する, **Then** 表示される料理が食材数30以下のものに即座に更新される
3. **Given** 鍋容量フィルターが適用されている, **When** フィルターをクリアする, **Then** すべての料理が再び表示される

---

### User Story 2 - 他のフィルターと組み合わせて使用する (Priority: P2)

ユーザーは鍋容量フィルターと既存の料理種別・食材フィルターを組み合わせて、より精密に料理を絞り込みたい。

**Why this priority**: 既存フィルターとの連携は機能の使い勝手を大幅に向上させるが、P1が動作していることが前提となる。

**Independent Test**: 鍋容量フィルターと料理種別フィルターを同時に適用し、両方の条件を満たす料理のみが表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** 料理一覧画面を表示している, **When** 鍋容量50と料理種別「カレー」を両方選択する, **Then** 食材数50以下のカレーのみが表示される
2. **Given** 鍋容量フィルターと食材フィルターが適用されている, **When** 鍋容量フィルターのみをクリアする, **Then** 食材フィルターは維持されたまま、鍋容量の制限がなくなる

---

### User Story 3 - よく使う鍋容量を素早く選択する (Priority: P3)

ユーザーはポケモンスリープで一般的な鍋サイズ（例：15, 21, 27など）を素早く選択したい。毎回数値を入力するのではなく、プリセットから選べると便利である。

**Why this priority**: 利便性の向上だが、手動入力でも目的は達成できるため優先度は低い。

**Independent Test**: プリセットボタンをクリックして、対応する鍋容量でフィルタリングされることを確認できる。

**Acceptance Scenarios**:

1. **Given** 料理一覧画面を表示している, **When** プリセット「Lv.1 (15)」を選択する, **Then** 鍋容量が15に設定され、食材数15以下の料理が表示される
2. **Given** プリセットが選択されている, **When** 手動で別の数値を入力する, **Then** プリセットの選択が解除され、入力した数値が適用される

---

### Edge Cases

- **鍋容量が0または空の場合**: フィルターが適用されず、すべての料理が表示される（「ごちゃまぜ」系の食材数0の料理も含む）
- **非常に大きな数値（例：999）を入力した場合**: すべての料理が表示される（現在の最大食材数は115）
- **負の数値を入力した場合**: 入力を無効として扱い、フィルターを適用しない
- **小数点を入力した場合**: 整数に丸めるか、入力を制限する

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは料理一覧画面に鍋容量フィルターのUI要素を表示しなければならない
- **FR-002**: ユーザーは鍋容量を数値入力で指定できなければならない
- **FR-003**: システムは指定された鍋容量以下の `ingredientCount` を持つ料理のみを表示しなければならない
- **FR-004**: 鍋容量フィルターは既存の料理種別フィルター・食材フィルターと併用できなければならない
- **FR-005**: ユーザーは鍋容量フィルターをクリアして全料理を表示できなければならない
- **FR-006**: システムはポケモンスリープの標準的な鍋サイズをプリセットとして提供しなければならない（Lv.1: 15, Lv.2: 21, Lv.3: 27, Lv.4: 33, Lv.5: 39, Lv.6: 45, Lv.7: 51, Lv.8: 57, Max: 57+）
- **FR-007**: 鍋容量に無効な値（負の数、非数値）が入力された場合、システムはフィルターを適用しないか、エラー表示をしなければならない
- **FR-008**: システムは現在適用中のフィルター状態（鍋容量を含む）を画面上に明示しなければならない

### Key Entities

- **Recipe（料理）**: 既存エンティティ。`ingredientCount` 属性が鍋容量フィルターの基準となる
- **Pot Capacity Filter（鍋容量フィルター）**: ユーザーが入力した鍋容量値。0以上の整数

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: ユーザーは5秒以内に鍋容量フィルターを設定し、フィルター結果を確認できる
- **SC-002**: フィルター適用後の料理一覧は1秒以内に更新される
- **SC-003**: プリセットボタンをタップしてから結果が表示されるまで1秒以内
- **SC-004**: 鍋容量フィルターと既存フィルター（種別・食材）を組み合わせた場合でも、正確にAND条件でフィルタリングされる

## Assumptions

- ポケモンスリープの鍋サイズのプリセット値（15, 21, 27, 33, 39, 45, 51, 57）は2025年時点のゲーム仕様に基づく
- 鍋容量の最大値は57だが、将来のアップデートで変更される可能性がある
- ユーザーは整数値のみを入力することを想定（小数は入力不可とする）
